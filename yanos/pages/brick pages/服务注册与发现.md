tags:: #注册数据 #分组 #心跳 #换节点 #客户端容错 #体量小

-
- 服务端启动的时候，需要往注册中心里注册自身的信息，主要是定位信息。
  logseq.order-list-type:: number
- 注册成功之后，注册中心和服务端要保持心跳。
  logseq.order-list-type:: number
- 客户端第一次发起对某个服务的调用之前，要先找注册中心获得所有可用服务节点列表，随后客户端会在本地缓存每个服务对应的可用节点列表。
  logseq.order-list-type:: number
- 客户端和注册中心要保持心跳和数据同步，后续服务端有任何变动，注册中心都会通知客户端，客户端会更新本地的可用节点列表。
  logseq.order-list-type:: number
- 客户端发送请求。
  logseq.order-list-type:: number
- 服务端返回响应。
  logseq.order-list-type:: number
-
-
- **服务注册与发现怎么保证高可用？**
- 注册服务端崩溃检测
	- 这种检测就是利用心跳来进行的。当注册中心发现和服务端的心跳失败了，那么它就应该认为服务端可能已经崩溃了，就立刻通知客户端停止使用该服务端。但是这种失败可能是偶发性的失败，比如说因为网络偶尔不稳定造成的。所以注册中心要继续保持心跳。如果几次心跳都失败了，那么就可以认为服务端已经彻底不可用了。但是如果心跳再次恢复了，那么注册中心就要再次告诉客户端这个服务端是可用的。
	- 立刻重试几次，如果都失败了就再间隔一段时间继续重试。所有的重试机制实际上也是要谨慎考虑重试次数和重试间隔的，确保在业务可以接受的范围内重试成功。不过再怎么样，从服务端崩溃到客户端知道，中间总是存在一个时间误差的，这时候就需要客户端来做容错了。
- 客户端容错
	- 尽量在注册中心或者服务端节点出现问题的时候，依旧保证请求能够发送到正确的服务端节点上。一般的策略是客户端在发现调不通之后，应该尝试换另外一个节点进行重试。如果客户端上的服务发现组件或者负载均衡器能够根据调用结果来做一些容错的话，那么它们应该要尝试将这个节点挪出可用节点列表，在短时间内不要再使用这个节点了。后面再考虑将这个节点挪回去。
- 注册中心选型
	- 注册中心更加关注 CAP 中选 CP 还是选 AP 的问题
	- >C：Consistency，数据一致性A：Availability，服务可用性P：Partition-tolerance，分区容错性
	-